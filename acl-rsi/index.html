<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ACL RSI — Score reprise du sport LCA (calcul local)</title>
</head>
<body>

<div class="wrap">
  <h2>ACL RSI (Anterior Cruciate Ligament – Return to Sport and Injury)</h2>

  <p class="note">
    <strong>Instructions :</strong><br>
    Merci de répondre aux questions suivantes concernant le sport principal que vous pratiquiez avant l’accident.<br>
    Pour chaque question, cochez la case entre les deux extrêmes selon ce qui vous parait correspondre le mieux à la situation actuelle de votre genou.
  </p>

  <div class="meta">
    <div class="field">
      <label for="knee">Genou concerné (optionnel)</label>
      <select id="knee">
        <option value="">—</option>
        <option value="droit">Droit</option>
        <option value="gauche">Gauche</option>
      </select>
    </div>
    <div class="field">
      <label for="sport">Sport principal (optionnel)</label>
      <input id="sport" placeholder="Ex : football, course, tennis…" />
    </div>
  </div>

  <div id="form" class="form"></div>

  <div class="actions">
    <button type="button" id="calc">Afficher mon score</button>
    <button type="button" id="copy" class="secondary" disabled>Copier mon score</button>
    <button type="button" id="reset" class="secondary">Réinitialiser</button>
  </div>

  <div id="msg" class="msg" aria-live="polite"></div>

  <div id="results" class="results" style="display:none;">
    <h3>Résultat</h3>
    <div id="resBox"></div>
    <div class="final" id="finalLine" style="display:none;"></div>
    <p class="note2">Merci de communiquer ce score à votre praticien.</p>
  </div>

  <hr class="hr" />

  <p class="attrib">
    <strong>Score ACL-RSI (Total x 100) / 120 = ____ %</strong><br>
    Aucune donnée n’est envoyée ni enregistrée (calcul local dans votre navigateur).
  </p>
</div>

<style>
  .wrap{max-width:980px;margin:0 auto;padding:12px 10px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  .note{background:#f6f7f8;border-left:4px solid #d0d3d6;padding:10px 12px;border-radius:6px}
  .meta{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0}
  .field{flex:1 1 260px}
  label{display:block;font-size:13px;margin:0 0 6px;color:#333}
  input,select{width:100%;padding:10px;border-radius:8px;border:1px solid #cfd3d7;background:#fff}

  .form{display:flex;flex-direction:column;gap:12px;margin-top:8px}
  .item{border:1px solid #e6e7e9;border-radius:10px;padding:12px;background:#fff}
  .item h4{margin:0 0 10px;font-size:16px}

  .anchors{display:flex;justify-content:space-between;gap:10px;font-size:13px;color:#111;margin:6px 0 10px}
  .anchors .left{max-width:45%}
  .anchors .right{max-width:45%;text-align:right}

  .scale{display:flex;flex-wrap:wrap;gap:6px;align-items:center}
  .pill{position:relative}
  .pill input{position:absolute;opacity:0;pointer-events:none}
  .pill span{
    display:inline-block;
    min-width:36px;
    text-align:center;
    padding:8px 10px;
    border:1px solid #cfd3d7;
    border-radius:999px;
    background:#fff;
    cursor:pointer;
    font-weight:700;
    user-select:none;
  }
  .pill input:checked + span{
    border-color:#111;
    background:#111;
    color:#fff;
  }

  .actions{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
  button{padding:10px 14px;border-radius:10px;border:0;cursor:pointer;background:#111;color:#fff;font-weight:700}
  button.secondary{background:#e6e7e9;color:#111}
  button:disabled{opacity:.5;cursor:not-allowed}

  .msg{margin-top:10px;font-size:14px}
  .results{margin-top:16px;background:#f6f7f8;border:1px solid #e6e7e9;border-radius:12px;padding:12px}
  .final{margin-top:12px;background:#fff;border:1px dashed #cfd3d7;border-radius:10px;padding:10px;font-weight:800}
  .note2{margin-top:10px;font-weight:700}
  .hr{margin:18px 0;border:none;border-top:1px solid #e6e7e9}
  .attrib{font-size:12px;color:#555}
</style>

<script>
(function(){
  // Questions + ancres : reprises telles que dans votre document.
  const ITEMS = [
    { q: "Pensez-vous pouvoir pratiquer votre sport au même niveau qu’auparavant ?", left: "Pas du tout sûr", right: "Totalement sûr" },
    { q: "Pensez-vous que vous pourriez vous blesser de nouveau le genou si vous repreniez le sport ?", left: "Extrêmement probable", right: "Pas du tout probable" },
    { q: "Êtes-vous inquiet à l’idée de reprendre votre sport ?", left: "Extrêmement inquiet", right: "Pas du tout inquiet" },
    { q: "Pensez-vous que votre genou sera stable lors de votre pratique sportive ?", left: "Pas du tout sûr", right: "Totalement sûr" },
    { q: "Pensez-vous pouvoir pratiquer votre sport sans vous soucier de votre genou ?", left: "Pas du tout sûr", right: "Totalement sûr" },
    { q: "Etes-vous frustré de devoir tenir compte de votre genou lors de votre pratique sportive ?", left: "Extrêmement frustré", right: "Pas du tout frustré" },
    { q: "Craignez-vous de vous blesser de nouveau le genou lors de votre pratique sportive ?", left: "Crainte extrême", right: "Aucune crainte" },
    { q: "Pensez-vous que votre genou peut résister aux contraintes ?", left: "Pas du tout sûr", right: "Totalement sûr" },
    { q: "Avez-vous peur de vous reblesser accidentellement le genou lors de votre pratique sportive ?", left: "Très peur", right: "Pas du tout peur" },
    { q: "Est-ce que l’idée de devoir éventuellement vous faire réopérer ou rééduquer vous empêche de pratiquer votre sport ?", left: "Tout le temps", right: "A aucun moment" },
    { q: "Etes-vous confiant en votre capacité à bien pratiquer votre sport ?", left: "Pas du tout confiant", right: "Totalement confiant" },
    { q: "Vous sentez-vous détendu à l’idée de pratiquer votre sport ?", left: "Pas du tout détendu", right: "Totalement détendu" }
  ];

  const form = document.getElementById("form");

  function makeScale(name){
    const scale = document.createElement("div");
    scale.className = "scale";
    for(let i=0;i<=10;i++){
      const lab = document.createElement("label");
      lab.className = "pill";
      lab.innerHTML = `<input type="radio" name="${name}" value="${i}"><span>${i}</span>`;
      scale.appendChild(lab);
    }
    return scale;
  }

  ITEMS.forEach((it, idx)=>{
    const block = document.createElement("div");
    block.className = "item";
    block.innerHTML = `<h4>${idx+1}. ${it.q}</h4>
      <div class="anchors">
        <div class="left"><strong>${it.left}</strong></div>
        <div class="right"><strong>${it.right}</strong></div>
      </div>`;
    block.appendChild(makeScale(`i_${idx}`));
    form.appendChild(block);
  });

  function round1(x){ return Math.round(x*10)/10; }
  function fmt1(x){
    const s = (Math.round(x*10)/10).toFixed(1);
    return s.replace(".", ",");
  }

  function getValue(name){
    const el = document.querySelector(`input[name="${name}"]:checked`);
    return el ? parseInt(el.value,10) : null;
  }

  function compute(){
    let sum = 0;
    let missing = 0;

    for(let i=0;i<ITEMS.length;i++){
      const v = getValue(`i_${i}`);
      if(v === null){ missing++; continue; }
      sum += v;
    }
    const score100 = (missing===0) ? round1((sum * 100) / 120) : null; // formule du document
    return {sum, score100, missing};
  }

  function render(res){
    if(res.missing>0){
      return `<p><strong>Il manque ${res.missing} réponse(s).</strong> Merci de compléter toutes les questions.</p>`;
    }
    return `
      <p><strong>Total :</strong> ${res.sum} / 120</p>
      <p><strong>Score ACL-RSI :</strong> ${fmt1(res.score100)} / 100</p>
      <p style="font-size:12px;color:#555">Calcul : Score ACL-RSI (Total x 100) / 120.</p>
    `;
  }

  const msg = document.getElementById("msg");
  const results = document.getElementById("results");
  const resBox = document.getElementById("resBox");
  const copyBtn = document.getElementById("copy");
  const finalLine = document.getElementById("finalLine");

  let lastSummary = "";

  async function copyText(text){
    try{
      if(navigator.clipboard && window.isSecureContext){
        await navigator.clipboard.writeText(text);
        return true;
      }
    }catch(e){}
    try{
      window.prompt("Copiez ce texte :", text);
      return true;
    }catch(e){}
    return false;
  }

  document.getElementById("calc").addEventListener("click", ()=>{
    msg.textContent = "";
    copyBtn.disabled = true;
    finalLine.style.display = "none";
    finalLine.textContent = "";
    lastSummary = "";

    const R = compute();
    resBox.innerHTML = render(R);
    results.style.display = "block";

    if(R.missing>0){
      msg.textContent = "Certaines réponses sont manquantes. Merci de tout compléter.";
      return;
    }

    const knee = document.getElementById("knee").value;
    const sport = document.getElementById("sport").value.trim();

    const kneeTxt = knee ? ` — genou ${knee}` : "";
    const sportTxt = sport ? ` — sport: ${sport}` : "";
    lastSummary = `ACL-RSI${kneeTxt}${sportTxt} — score ${fmt1(R.score100)}/100 (total ${R.sum}/120)`;

    finalLine.textContent = lastSummary;
    finalLine.style.display = "block";
    copyBtn.disabled = false;
  });

  copyBtn.addEventListener("click", async ()=>{
    if(!lastSummary) return;
    const ok = await copyText(lastSummary);
    msg.textContent = ok ? "Score copié." : "Impossible de copier automatiquement.";
  });

  document.getElementById("reset").addEventListener("click", ()=>{
    for(let i=0;i<ITEMS.length;i++){
      const checked = document.querySelector(`input[name="i_${i}"]:checked`);
      if(checked) checked.checked = false;
    }
    document.getElementById("knee").value="";
    document.getElementById("sport").value="";
    msg.textContent="";
    results.style.display="none";
    copyBtn.disabled = true;
    finalLine.style.display = "none";
    finalLine.textContent = "";
    lastSummary = "";
  });
})();
</script>

</body>
</html>
